plugins {
    id "org.grails.forge.internal.test-module"
    id "org.grails.forge.rocker"
}

ext {
    picocliVersion = '4.7.5'
}

sourceSets {
    test {
        rocker {
            srcDir("src/test/groovy")
        }
    }
}

configurations {
    generateConfig
    all {
        resolutionStrategy {
            // prevent fatJar result containing multiple versions of picocli
            force("info.picocli:picocli:$picocliVersion")
        }
    }
}

dependencies {
//    testImplementation project(":test-utils")
    testImplementation project(":grails-forge-core")
    testImplementation project(":grails-cli")
    testImplementation "ch.qos.logback:logback-classic:1.5.10"
    testImplementation "io.micronaut.picocli:micronaut-picocli"
    implementation "io.micronaut:micronaut-inject-groovy:$micronautVersion"
    generateConfig "info.picocli:picocli-codegen:${picocliVersion}"
}

tasks.withType(Test).configureEach {
    forkEvery = 10
}